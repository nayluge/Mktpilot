{% set page ='product' %}
{% extends "OcaratCoreBundle::template.html.twig" %}

{% block stylesheets %}
    {{ parent() }}
    <link rel="stylesheet" href="/bundles/ocaratcore/js/plugins/chosen/chosen.css">
{% endblock %}

{% block content %}

    <!-- Get Started Block -->

    <div class="block full">
        <div class="block-title">
            <h2>Analyse des revenus par catégories et attributs </h2>
        </div>
        <form action="" method="post">
        <div class="search">
            <select name="include[]" class="chosen-select" multiple="true" style="width: 100%;" data-placeholder="Catégories et attributs à rechercher" tabindex="-1">
                <optgroup label="Attributs">
                    {% for attribut in attributes %}
                        <option value="attr_{{ attribut['id_feature_value'] }}" {% if ("attr_" ~ attribut['id_feature_value']) in app.request.get('include') %} selected {% endif %}>{{ attribut['name'] }}</option>
                    {% endfor %}
                </optgroup>
                <optgroup label="Catégories">
                    {% for category in categories %}
                        <option value="cat_{{ category['id_category'] }}" {% if ("cat_" ~ category['id_category']) in app.request.get('include') %} selected {% endif %}>{{ category['name'] }}</option>
                    {% endfor %}

                </optgroup>
            </select>
            <br><br>
            <select name="exclude[]" class="chosen-select" multiple style="width: 100%;" data-placeholder="Catégories et attributs à exclure">
                <optgroup label="Attributs">
                    {% for attribut in attributes %}
                        <option value="attr_{{ attribut['id_feature_value'] }}" {% if ("attr_" ~ attribut['id_feature_value']) in app.request.get('exclude') %} selected {% endif %}>{{ attribut['name'] }}</option>
                    {% endfor %}
                </optgroup>
                <optgroup label="Catégories">
                    {% for category in categories %}
                        <option value="cat_{{ category['id_category'] }}" {% if ("cat_" ~ category['id_category']) in app.request.get('exclude') %} selected {% endif %}>{{ category['name'] }}</option>
                    {% endfor %}

                </optgroup>
            </select>
            <br><br>
            <input class="btn btn-success" type="submit" value="Rechercher">
        </div>
        </form>
    </div>

    {% if result is defined %}

        <div class="block-full">

        </div>
    {% endif %}

{% endblock %}

{% block javascripts %}
  {{ parent() }}
    <script src="{{ asset('bundles/ocaratcore/js/plugins/chosen/chosen.jquery.js') }}" type="text/javascript"></script>
    <script type="text/javascript">
        var config = {
            '.chosen-select'           : {},
            '.chosen-select-deselect'  : {allow_single_deselect:true},
            '.chosen-select-no-single' : {disable_search_threshold:10},
            '.chosen-select-no-results': {no_results_text:'Oops, nothing found!'},
            '.chosen-select-width'     : {width:"95%"}
        }
        for (var selector in config) {
            $(selector).chosen(config[selector]);
        }
    </script>
{% endblock %}


